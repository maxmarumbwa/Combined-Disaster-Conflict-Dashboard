<!DOCTYPE html>
<html>
{% load static %}

<head>
    <title>ADM1 Map</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
        #map {
            height: 100vh;
        }
    </style>
</head>

<body>
    <div id="map"></div>

    <script>
        const map = L.map("map").setView([-4.1, 23.6], 5);

        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
            maxZoom: 18
        }).addTo(map);

        // Load ADM1 geometry ONCE
        let adm1Layer;
        const GEOJSON_URL = "{% static 'data/geojson/a.geojson' %}";
        //fetch("http://localhost:8000/api/geojson/adm1/") // dont fetch from db its very slow
        fetch(GEOJSON_URL)
            .then(res => res.json())
            .then(data => {
                adm1Layer = L.geoJSON(data, {
                    style: {
                        color: "#333",
                        weight: 1,
                        fillOpacity: 0.4
                    },
                    onEachFeature: (feature, layer) => {
                        layer.bindPopup(feature.properties.shapename2);
                    }
                }).addTo(map);
            });
    </script>
</body>

</html>